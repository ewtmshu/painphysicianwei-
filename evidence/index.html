<!doctype html><html lang="zh-Hant"><head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>健康實證 | PainPhysicianWei</title>
<link rel="stylesheet" href="/styles.css"/></head><body>
<header><div class="container" style="display:flex;align-items:center;justify-content:space-between;">
  <a href="/index.html" class="btn" style="border:none;padding:0;font-weight:600;">PainPhysicianWei</a>
  <nav>
    <a href="/doctor/">醫師介紹</a>
    <a href="/visit/">就診資訊</a>
    <a href="/cases/">案例分享</a>
    <a href="/evidence/">健康實證</a>
    <a href="/social/">社群連結</a>
  </nav>
</div></header>

<main class="container">
  <h1>健康實證</h1>
  <p class="small">整理 PRP、BMAC 與肌骨介入等循證重點。</p>

  <!-- WordPress 文章會插在這裡 -->
  <div id="wp-evidence-list" class="grid grid-2" style="margin-top:16px"></div>
</main>

<footer><div class="container small">© PainPhysicianWei</div></footer>

<script>
(async function loadWP(categorySlug, mountId){
  const api = 'https://cms.painphysicianwei.tw/wp-json/wp/v2';
  try {
    // 1) 找分類 id
    const catRes = await fetch(`${api}/categories?slug=${categorySlug}`);
    const catArr = await catRes.json();
    const cat = catArr && catArr[0];
    if(!cat){ document.getElementById(mountId).innerHTML = '<p class="small">找不到分類（檢查 slug 是否為 evidence）</p>'; return; }

    // 2) 抓文章（含精選圖）
    const res = await fetch(`${api}/posts?categories=${cat.id}&_embed&per_page=12&status=publish`);
    const posts = await res.json();

    // 3) 畫卡片
    const el = document.getElementById(mountId);
    el.innerHTML = (posts || []).map(p => {
      const img = p._embedded?.['wp:featuredmedia']?.[0]?.source_url || '';
      const title = p.title?.rendered || '';
      const excerpt = (p.excerpt?.rendered || '').replace(/<[^>]+>/g,'').slice(0,120);
      const url = p.link; // 先導去 WP 文章頁
      return `
        <a class="card" href="${url}" target="_blank" rel="noreferrer">
          ${img ? `<img src="${img}" alt="" style="width:100%;border-radius:12px;margin-bottom:8px;object-fit:cover;max-height:180px"/>` : ''}
          <h3>${title}</h3>
          <p class="small">${excerpt || '（內文摘要）'}</p>
        </a>
      `;
    }).join('') || '<p class="small">尚無文章，請到 WP 後台新增並設為公開。</p>';
  } catch (e) {
    document.getElementById(mountId).innerHTML = '<p class="small">讀取失敗，稍後再試。</p>';
  }
})('evidence','wp-evidence-list');
</script>
</body></html>
